<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Auth Callback</title>
  <style>
    :root {
      --primary: #4f46e5;
      --success: #10b981;
      --error: #ef4444;
      --text: #374151;
      --background: #f9fafb;
      --card-bg: #ffffff;
      --shadow: rgba(0, 0, 0, 0.05);
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      padding: 0;
      margin: 0;
      background-color: var(--background);
      color: var(--text);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
    }
    
    .container {
      width: 90%;
      max-width: 460px;
      background-color: var(--card-bg);
      padding: 32px 28px;
      border-radius: 16px;
      box-shadow: 0 10px 25px var(--shadow), 0 2px 10px var(--shadow);
      position: relative;
      overflow: hidden;
      transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1);
    }
    
    h2 {
      margin: 0 0 24px;
      font-weight: 600;
      color: #111827;
      font-size: 1.75rem;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.6s forwards 0.2s;
    }
    
    .google-logo {
      width: 28px;
      height: 28px;
      margin-bottom: 16px;
      opacity: 0;
      animation: popIn 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    
    .loader {
      border: 4px solid rgba(79, 70, 229, 0.1);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      width: 56px;
      height: 56px;
      margin: 20px auto;
      animation: spin 1.2s cubic-bezier(0.22, 1, 0.36, 1) infinite;
      opacity: 0;
      transform: scale(0.8);
      animation: spin 1.2s cubic-bezier(0.22, 1, 0.36, 1) infinite, fadeIn 0.5s forwards 0.4s;
    }
    
    .success-icon, .error-icon {
      width: 60px;
      height: 60px;
      margin: 20px auto;
      display: none;
      opacity: 0;
      transform: scale(0.8);
    }
    
    .success .success-icon {
      display: block;
      animation: popIn 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    
    .error .error-icon {
      display: block;
      animation: popIn 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    
    .success .loader, .error .loader {
      display: none;
    }
    
    .message {
      margin: 20px 0;
      color: #6b7280;
      font-size: 1.05rem;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.6s forwards 0.5s;
      transition: color 0.3s;
    }
    
    .progress-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 4px;
      width: 0;
      background: linear-gradient(90deg, var(--primary), #818cf8);
      transition: width 2.5s cubic-bezier(0.22, 1, 0.36, 1);
    }
    
    .background-shapes div {
      position: absolute;
      border-radius: 50%;
      opacity: 0.04;
      z-index: -1;
      filter: blur(40px);
    }
    
    .shape1 {
      width: 100px;
      height: 100px;
      background-color: var(--primary);
      top: -20px;
      right: -30px;
    }
    
    .shape2 {
      width: 150px;
      height: 150px;
      background-color: var(--primary);
      bottom: -40px;
      left: -50px;
    }
    
    .success .message {
      color: var(--success);
    }
    
    .error .message {
      color: var(--error);
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(180deg) scale(1.1); }
      100% { transform: rotate(360deg) scale(1); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from { 
        opacity: 0;
        transform: translateY(15px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes popIn {
      0% { 
        opacity: 0;
        transform: scale(0.8);
      }
      70% { 
        opacity: 1;
        transform: scale(1.1);
      }
      100% { 
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <div class="container" id="authContainer">
    <div class="background-shapes">
      <div class="shape1"></div>
      <div class="shape2"></div>
    </div>
    <svg class="google-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
      <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/>
      <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/>
      <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"/>
      <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/>
    </svg>
    <h2>Authentication</h2>
    <div class="loader"></div>
    <svg class="success-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="#10b981" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="#ef4444" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <p class="message">We're authenticating your account...</p>
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <script>
    // Extract params from URL hash (part after #)
    function getHashParams() {
      const hashParams = {};
      const hash = window.location.hash.substring(1);
      
      if (hash) {
        const params = hash.split('&');
        
        for (let i = 0; i < params.length; i++) {
          const pair = params[i].split('=');
          hashParams[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');
        }
      }
      
      return hashParams;
    }

    // Handle page load processing
    window.onload = function() {
      const container = document.getElementById('authContainer');
      const progressBar = document.getElementById('progressBar');
      const messageEl = document.querySelector('.message');
      
      // Start progress bar animation
      setTimeout(() => {
        progressBar.style.width = '100%';
      }, 100);
      
      try {
        // Get params from URL hash
        const params = getHashParams();
        
        // Check for access_token
        if (params.access_token) {
          // Wait for animation to run a bit for better UX
          setTimeout(() => {
            // Show success state
            container.classList.add('success');
            messageEl.textContent = 'Authentication successful! Redirecting...';
            
            // Send message to parent window with token
            window.opener.postMessage({
              type: 'oauth_response',
              provider: 'google',
              response: params
            }, window.opener.location.origin);
            
            // Close popup after showing success state
            setTimeout(() => {
              window.close();
            }, 1500);
          }, 1200);
        } else {
          // Handle error after delay for animation
          setTimeout(() => {
            container.classList.add('error');
            messageEl.textContent = 'Authentication failed. Please try again.';
            
            // Close popup after error display
            setTimeout(() => {
              window.close();
            }, 2000);
          }, 1000);
        }
      } catch (error) {
        console.error('Error during authentication:', error);
        
        // Show error state after delay for animation
        setTimeout(() => {
          container.classList.add('error');
          messageEl.textContent = 'An error occurred during authentication.';
          
          // Close popup after error display
          setTimeout(() => {
            window.close();
          }, 2000);
        }, 1000);
      }
    };
  </script>
</body>
</html> 